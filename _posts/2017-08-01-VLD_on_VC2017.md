---
layout: post
title:  "Visual Leak Detector on Visual C++ 2017"
categories: Tools
tags:  Visual_Studio VLD
author: 辛亚平
---

* content
{:toc}

Visual Leak Detector（以下简称：VLD） 是一个著名的 C/C++ 程序内存泄漏检测插件，而且还是免费且开源的。自从几年前发现了它，我一直用它直到现在。然而，现在最新版本的 VLD v2.5.1 官方并不支持 Visual Studio 2017，只支持 Visual Studio 2008 到 Visual Studio 2015。

真的不支持 Visual Studio 2017 吗？其实并非如此。在本文中我们就来试一试。

![VLD Logo](/attachment/daily/2017/1003/VLD_VC2017/VLD_Logo.png)



## 软件环境

Visual Studio 2017 （安装了 C/C++ 开发组件）

Visual Leak Detector v2.5.1

## 安装并配置 VLD

目前 VLD 的源代码及安装文件托管在 codeplex.com 上。地址为：[https://vld.codeplex.com](https://vld.codeplex.com/)

下载最新版本（v2.5.1）的安装文件，安装。

![Using Visual Leak Detector](/attachment/daily/2017/1003/VLD_VC2017/A01-01.png)


我的安装路径为：D:\Apps\x86\Visual_Leak_Detector

你要记住你自己的安装路径，这个路径一会儿我们要用到的。


在 VLD 官方网站上查看帮助文档的“[Using Visual Leak Detector](https://vld.codeplex.com/wikipage?title=Using%20Visual%20Leak%20Detector&referringTitle=Documentation)”部分。

![Using Visual Leak Detector](/attachment/daily/2017/1003/VLD_VC2017/VLD_How_to_use.png)

按照这个说明，用 Visual Studio 2017 打来任意一个 C/C++ 工程，然后找到 View ->Property Manager | Microsoft.Cpp.Win32.user


![](/attachment/daily/2017/1003/VLD_VC2017/A01-03.png)

![](/attachment/daily/2017/1003/VLD_VC2017/A01-03_02.png)

在 VC++ Directories | Include files 中，增加以下路径并将其移到最底端（读者请自行将以下路径替换为你实际的路径）：

```
D:\Apps\x86\Visual_Leak_Detector\include
```

![](/attachment/daily/2017/1003/VLD_VC2017/A01-06.png)

在 Library files 中，增加以下路径并将其移到最底端（读者请自行将以下路径替换为你实际的路径）：

```
D:\Apps\x86\Visual_Leak_Detector\lib\Win32
```

![](/attachment/daily/2017/1003/VLD_VC2017/A01-07.png)



找到 View ->Property Manager | Microsoft.Cpp.Win64.user

![](/attachment/daily/2017/1003/VLD_VC2017/A01-08.png)

在 VC++ Directories | Include files 中，增加以下路径并将其移到最底端（读者请自行将以下路径替换为你实际的路径）：

```
D:\Apps\x86\Visual_Leak_Detector\include
```

![](/attachment/daily/2017/1003/VLD_VC2017/A01-10.png)

在 Library files 中，增加以下路径并将其移到最底端（读者请自行将以下路径替换为你实际的路径）：

```
D:\Apps\x86\Visual_Leak_Detector\lib\Win64
```

![](/attachment/daily/2017/1003/VLD_VC2017/A01-12.png)







## 卸载 Unity

现在你已经可以在 Ubuntu 上使用 gnome 桌面了，目的已经达到。但如果你介意 Unity 桌面依然占着你的硬盘，你可以卸载 Unity。

卸载的步骤如下：

（1）首先安装 gdm

```
sudo apt-get install gdm
```

然后，配置 X 的默认的界面管理器，将 Default Display Manager 设置为 gdm：

```
sudo dpkg-reconfigure lightdm
```

![](/attachment/daily/2017/1003/Uninstall-Unity/A02-01.png)

![将 Default Display Manager 设置为 gdm](/attachment/daily/2017/1003/Uninstall-Unity/A02-02.png)


接下来就可以卸载掉不再需要的软件包了：

```
sudo apt-get remove unity
sudo apt-get remove lightdm
sudo apt-get remove ubuntu-desktop
sudo apt-get remove --purge unity
sudo apt-get remove --purge lightdm
sudo apt-get autoremove
```


## 也可以不卸载 lightdm

其实我觉得 lightdm 比 gdm 好一些。你也可以不卸载 lightdm，依然使用 lightdm 为 Default Display Manager。

这样的话，就只需要卸载掉 unity 就可以了：

```
sudo apt-get remove unity
sudo apt-get remove --purge unity
sudo apt-get autoremove
```

## 注意事项

我发现，当 Default Display Manager 发生变化以后，输入法可能会需要重新配置一下。



## 参考文章

- [How can you remove Unity?](https://askubuntu.com/questions/6302/how-can-you-remove-unity)
- [Can I remove Unity now and how?](https://askubuntu.com/questions/651013/can-i-remove-unity-now-and-how)
- [How to Install the Gnome Classic Desktop in Ubuntu 14.04](https://www.howtogeek.com/189912/how-to-install-the-gnome-classic-desktop-in-ubuntu-14.04/)
- [Install Gnome Classic (Gnome Session Fallback) to Ubuntu 12.04](http://blog.csdn.net/shaonan155/article/details/17789619)
